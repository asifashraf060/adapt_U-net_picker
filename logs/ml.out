================================================================================
PHYSICS-INFORMED SEISMIC PHASE PICKER - ML PIPELINE
================================================================================
üîß Configuration: Physics-Informed mode
üîß Max Amplitude: Enabled
üïê Training epochs: 200
üìä Database: seismic_data_s3.db

================================================================================
üìä PICK AVAILABILITY ANALYSIS
================================================================================
Total waveforms in database: 1195

Pick availability breakdown:
  PhaseNet picks available:   1195 (100.0%)
  Manual picks available:     1178 (98.6%)
  Both picks available:       1178 (98.6%)
  No picks available:            0 (0.0%)

‚úÖ Using MANUAL picks for training
   Available waveforms with manual picks: 1178


--------------------------------------------------
LOADING DATA FROM DATABASE - PHYSICS-INFORMED MODE
--------------------------------------------------
Creating training dataset...
Available tables in database: ['earthquakes', 'sqlite_sequence', 'waveforms']
Loading training set: 942 waveforms (Manual picks)
Successfully processed 942 waveforms
Creating validation dataset...
Available tables in database: ['earthquakes', 'sqlite_sequence', 'waveforms']
Loading validation set: 236 waveforms (Manual picks)
Successfully processed 236 waveforms
‚úÖ Training dataset size: 942
‚úÖ Validation dataset size: 236

üìä VISUALIZING PHYSICS-INFORMED FEATURES
--------------------------------------------------
Visualizing and saving waveform features...


--------------------------------------------------
INITIALIZING PHYSICS-INFORMED MODEL
--------------------------------------------------
‚úÖ Input channels (features): 19
‚úÖ Feature shape: torch.Size([19, 12300])
Total parameters: 2,833,558
Trainable parameters: 2,833,558


--------------------------------------------------
üöÄ STARTING TRAINING
--------------------------------------------------
Epoch 1/200, Train Loss: 0.4173, Val Loss: 0.3519, LR: 0.001000
Epoch 2/200, Train Loss: 0.3446, Val Loss: 0.3391, LR: 0.001000
Epoch 3/200, Train Loss: 0.3367, Val Loss: 0.3359, LR: 0.001000
Epoch 4/200, Train Loss: 0.3348, Val Loss: 0.3350, LR: 0.001000
Epoch 5/200, Train Loss: 0.3338, Val Loss: 0.3332, LR: 0.001000
Epoch 6/200, Train Loss: 0.3328, Val Loss: 0.3319, LR: 0.001000
Epoch 7/200, Train Loss: 0.3322, Val Loss: 0.3315, LR: 0.001000
Epoch 8/200, Train Loss: 0.3306, Val Loss: 0.3323, LR: 0.001000
Epoch 9/200, Train Loss: 0.3302, Val Loss: 0.3295, LR: 0.001000
Epoch 10/200, Train Loss: 0.3284, Val Loss: 0.3280, LR: 0.001000
Epoch 11/200, Train Loss: 0.3270, Val Loss: 0.3285, LR: 0.001000
Epoch 12/200, Train Loss: 0.3264, Val Loss: 0.3270, LR: 0.001000
Epoch 13/200, Train Loss: 0.3263, Val Loss: 0.3268, LR: 0.001000
Epoch 14/200, Train Loss: 0.3260, Val Loss: 0.3256, LR: 0.001000
Epoch 15/200, Train Loss: 0.3248, Val Loss: 0.3260, LR: 0.001000
Epoch 16/200, Train Loss: 0.3242, Val Loss: 0.3247, LR: 0.001000
Epoch 17/200, Train Loss: 0.3241, Val Loss: 0.3245, LR: 0.001000
Epoch 18/200, Train Loss: 0.3240, Val Loss: 0.3239, LR: 0.001000
Epoch 19/200, Train Loss: 0.3234, Val Loss: 0.3239, LR: 0.001000
Epoch 20/200, Train Loss: 0.3232, Val Loss: 0.3241, LR: 0.001000
Epoch 21/200, Train Loss: 0.3235, Val Loss: 0.3240, LR: 0.001000
Epoch 22/200, Train Loss: 0.3230, Val Loss: 0.3232, LR: 0.001000
Epoch 23/200, Train Loss: 0.3226, Val Loss: 0.3238, LR: 0.001000
Epoch 24/200, Train Loss: 0.3228, Val Loss: 0.3232, LR: 0.001000
Epoch 25/200, Train Loss: 0.3224, Val Loss: 0.3240, LR: 0.001000
Epoch 26/200, Train Loss: 0.3224, Val Loss: 0.3233, LR: 0.001000
Epoch 27/200, Train Loss: 0.3222, Val Loss: 0.3237, LR: 0.001000
Epoch 28/200, Train Loss: 0.3225, Val Loss: 0.3224, LR: 0.001000
Epoch 29/200, Train Loss: 0.3222, Val Loss: 0.3237, LR: 0.001000
Epoch 30/200, Train Loss: 0.3220, Val Loss: 0.3233, LR: 0.001000
Epoch 31/200, Train Loss: 0.3217, Val Loss: 0.3226, LR: 0.001000
Epoch 32/200, Train Loss: 0.3218, Val Loss: 0.3227, LR: 0.001000
Epoch 33/200, Train Loss: 0.3215, Val Loss: 0.3220, LR: 0.001000
Epoch 34/200, Train Loss: 0.3217, Val Loss: 0.3224, LR: 0.001000
Epoch 35/200, Train Loss: 0.3216, Val Loss: 0.3224, LR: 0.001000
Epoch 36/200, Train Loss: 0.3212, Val Loss: 0.3220, LR: 0.001000
Epoch 37/200, Train Loss: 0.3213, Val Loss: 0.3227, LR: 0.001000
Epoch 38/200, Train Loss: 0.3215, Val Loss: 0.3218, LR: 0.001000
Epoch 39/200, Train Loss: 0.3212, Val Loss: 0.3224, LR: 0.001000
Epoch 40/200, Train Loss: 0.3213, Val Loss: 0.3223, LR: 0.001000
Epoch 41/200, Train Loss: 0.3207, Val Loss: 0.3216, LR: 0.001000
Epoch 42/200, Train Loss: 0.3213, Val Loss: 0.3223, LR: 0.001000
Epoch 43/200, Train Loss: 0.3210, Val Loss: 0.3219, LR: 0.001000
Epoch 44/200, Train Loss: 0.3214, Val Loss: 0.3221, LR: 0.001000
Epoch 45/200, Train Loss: 0.3209, Val Loss: 0.3218, LR: 0.001000
Epoch 46/200, Train Loss: 0.3210, Val Loss: 0.3223, LR: 0.001000
Epoch 47/200, Train Loss: 0.3209, Val Loss: 0.3221, LR: 0.000500
Epoch 48/200, Train Loss: 0.3205, Val Loss: 0.3213, LR: 0.000500
Epoch 49/200, Train Loss: 0.3200, Val Loss: 0.3213, LR: 0.000500
Epoch 50/200, Train Loss: 0.3200, Val Loss: 0.3210, LR: 0.000500
Epoch 51/200, Train Loss: 0.3200, Val Loss: 0.3210, LR: 0.000500
Epoch 52/200, Train Loss: 0.3200, Val Loss: 0.3214, LR: 0.000500
Epoch 53/200, Train Loss: 0.3201, Val Loss: 0.3211, LR: 0.000500
Epoch 54/200, Train Loss: 0.3199, Val Loss: 0.3212, LR: 0.000500
Epoch 55/200, Train Loss: 0.3198, Val Loss: 0.3214, LR: 0.000500
Epoch 56/200, Train Loss: 0.3198, Val Loss: 0.3211, LR: 0.000500
Epoch 57/200, Train Loss: 0.3198, Val Loss: 0.3214, LR: 0.000250
Epoch 58/200, Train Loss: 0.3193, Val Loss: 0.3212, LR: 0.000250
Epoch 59/200, Train Loss: 0.3193, Val Loss: 0.3209, LR: 0.000250
Epoch 60/200, Train Loss: 0.3193, Val Loss: 0.3212, LR: 0.000250
Epoch 61/200, Train Loss: 0.3193, Val Loss: 0.3210, LR: 0.000250
Epoch 62/200, Train Loss: 0.3190, Val Loss: 0.3210, LR: 0.000250
Epoch 63/200, Train Loss: 0.3192, Val Loss: 0.3210, LR: 0.000250
Epoch 64/200, Train Loss: 0.3192, Val Loss: 0.3209, LR: 0.000250
Epoch 65/200, Train Loss: 0.3192, Val Loss: 0.3210, LR: 0.000125
Epoch 66/200, Train Loss: 0.3189, Val Loss: 0.3209, LR: 0.000125
Epoch 67/200, Train Loss: 0.3189, Val Loss: 0.3207, LR: 0.000125
Epoch 68/200, Train Loss: 0.3189, Val Loss: 0.3210, LR: 0.000125
Epoch 69/200, Train Loss: 0.3188, Val Loss: 0.3209, LR: 0.000125
Epoch 70/200, Train Loss: 0.3188, Val Loss: 0.3212, LR: 0.000125
Epoch 71/200, Train Loss: 0.3187, Val Loss: 0.3206, LR: 0.000125
Epoch 72/200, Train Loss: 0.3187, Val Loss: 0.3207, LR: 0.000125
Epoch 73/200, Train Loss: 0.3187, Val Loss: 0.3206, LR: 0.000125
Epoch 74/200, Train Loss: 0.3189, Val Loss: 0.3205, LR: 0.000125
Epoch 75/200, Train Loss: 0.3187, Val Loss: 0.3207, LR: 0.000125
Epoch 76/200, Train Loss: 0.3188, Val Loss: 0.3206, LR: 0.000125
Epoch 77/200, Train Loss: 0.3186, Val Loss: 0.3204, LR: 0.000125
Epoch 78/200, Train Loss: 0.3189, Val Loss: 0.3207, LR: 0.000125
Epoch 79/200, Train Loss: 0.3186, Val Loss: 0.3205, LR: 0.000125
Epoch 80/200, Train Loss: 0.3188, Val Loss: 0.3207, LR: 0.000125
Epoch 81/200, Train Loss: 0.3185, Val Loss: 0.3204, LR: 0.000125
Epoch 82/200, Train Loss: 0.3185, Val Loss: 0.3207, LR: 0.000125
Epoch 83/200, Train Loss: 0.3186, Val Loss: 0.3205, LR: 0.000125
Epoch 84/200, Train Loss: 0.3185, Val Loss: 0.3208, LR: 0.000125
Epoch 85/200, Train Loss: 0.3185, Val Loss: 0.3209, LR: 0.000125
Epoch 86/200, Train Loss: 0.3187, Val Loss: 0.3206, LR: 0.000125
Epoch 87/200, Train Loss: 0.3185, Val Loss: 0.3209, LR: 0.000063
Epoch 88/200, Train Loss: 0.3184, Val Loss: 0.3207, LR: 0.000063
Epoch 89/200, Train Loss: 0.3185, Val Loss: 0.3206, LR: 0.000063
Epoch 90/200, Train Loss: 0.3185, Val Loss: 0.3207, LR: 0.000063
Epoch 91/200, Train Loss: 0.3183, Val Loss: 0.3208, LR: 0.000063
Early stopping triggered
‚úÖ Loaded best model from training

üìä EVALUATING MODEL
--------------------------------------------------

üéØ PICK ACCURACY RESULTS - PHYSICS-INFORMED MODE (MANUAL PICKS)
======================================================================
Mean absolute error: 1.0831 ¬± 2.0176 seconds
Median absolute error: 0.7450 seconds
90th percentile error: 1.0200 seconds
95th percentile error: 1.6025 seconds

üìà Performance Categories:
  Excellent (< 0.5s):  33 (14.0%)
  Good (0.5-1.0s):   177 (75.0%)
  Fair (1.0-2.0s):    17 (7.2%)
  Poor (> 2.0s):       9 (3.8%)

üìä CREATING VISUALIZATIONS
--------------------------------------------------

üéõÔ∏è Final learned feature weights:
  Raw            : 0.7534
  STA/LTA 1      : 0.9374
  Log STA/LTA 1  : 0.7403
  STA/LTA 2      : 0.7994
  Log STA/LTA 2  : 0.5595
  STA/LTA 3      : 0.6265
  Log STA/LTA 3  : 0.4484
  Envelope       : 1.1225
  Env. Deriv.    : 2.1780
  Inst. Freq.    : 1.1890
  Low Energy     : 0.9507
  Low Env.       : 1.3527
  Mid Energy     : 1.2317
  Mid Env.       : 2.6393
  High Energy    : 1.3237
  High Env.      : 2.6821
  Max Amplitude  : 1.2974

üíæ Model saved as 'physics_informed_manual_phase_picker.pth'

üéâ TRAINING COMPLETE - PHYSICS-INFORMED MODE (MANUAL PICKS)!
================================================================================
